# 送信先メールアドレス（複数対応）仕様

作成日: 2026-01-30

## 概要

申込受付時の通知メール送信先を、複数アドレスで設定できる。設定された全てのアドレスに申込があった際にメールが送信される。

## 画面・ルート

| 画面 | URL | 説明 |
|------|-----|------|
| 管理者管理（一覧） | `/billing/admin/users` | 送信先メールアドレス一覧（複数件表示）と編集リンク |
| 送信先メールアドレス編集 | `/billing/admin/users/notification-email/edit` | テキストエリアで複数アドレスを入力・保存 |

## 入力形式

- **保存形式**: `site_settings` の `notification_email`（value_text）に改行区切りで保存
- **入力**: 1行1件、またはカンマ区切り。空行・前後空白は無視
- **バリデーション**: 各アドレスを `email` 形式・255文字以内で検証。1件以上必須

## 動作

1. **編集画面**: テキストエリアに登録済みアドレスを改行区切りで表示。保存時にパース・検証し改行区切りで保存
2. **一覧**: 登録済みアドレスをリスト表示（件数表示あり）
3. **送信テスト**: 登録済みの全アドレスにテストメールを一括送信
4. **申込受付時**: `ContractController` で申込完了時に、`SiteSetting::getNotificationEmailsArray()` で取得した全アドレスに `ContractNotificationMail` を送信

## モデル・ヘルパー

- `SiteSetting::getTextValue('notification_email', '')`: 生の文字列（改行区切り）
- `SiteSetting::getNotificationEmailsArray()`: パース済みの有効なメールアドレス配列（改行・カンマで分割し、`filter_var(..., FILTER_VALIDATE_EMAIL)` でフィルタ）

## 変更履歴

- 2026-01-30: 複数メールアドレス対応を追加（従来は単一のみ）
